<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>–†–∞–π–º–æ–Ω ‚Äî –¥—Ä–∞–∫–æ–Ω–∏–π —Ä—ã—Ü–∞—Ä—å</title>
<style>
  html,body{height:100%;margin:0}
  body{background:#eff1f3;font-family:system-ui,Segoe UI,Roboto,Manrope,sans-serif}
  #wrap{display:flex;align-items:center;justify-content:center;height:100%}
  canvas{background:#dfe6ea;box-shadow:0 8px 30px rgba(0,0,0,.15);border-radius:14px;max-width:100%;height:auto;touch-action:none}
  .hud{position:fixed;left:10px;top:10px;background:rgba(255,255,255,.9);padding:6px 10px;border-radius:10px;font-weight:800;z-index:2}
  .hint{position:fixed;left:10px;bottom:10px;background:rgba(255,255,255,.9);padding:6px 10px;border-radius:10px;font-weight:600;z-index:2}
  .summary{position:fixed;inset:0;background:rgba(0,0,0,.55);display:flex;align-items:center;justify-content:center;padding:20px;z-index:3}
  .summary .card{background:#fff;border-radius:16px;box-shadow:0 20px 80px rgba(0,0,0,.25);max-width:540px;width:100%;padding:22px}
  .summary h2{margin:0 0 8px 0}
  .btn{padding:10px 18px;font-size:16px;font-weight:700;border:none;border-radius:10px;cursor:pointer;background:#ff6b35;color:#fff;box-shadow:0 4px 10px rgba(0,0,0,.2)}
  .hidden{display:none}
</style>
</head>
<body>
<div class="hud">‚öîÔ∏è –ü–æ–±–µ–¥: <span id="score">0</span></div>
<div class="hint">A/D ‚Äî –±–µ–≥ ‚Ä¢ Space ‚Äî –ø—Ä—ã–∂–æ–∫ (√ó2 ‚Äî –ø–æ–ª—ë—Ç) ‚Ä¢ X ‚Äî —É–¥–∞—Ä –º–µ—á–æ–º ‚Ä¢ R ‚Äî —Ä–µ—Å—Ç–∞—Ä—Ç</div>
<div id="wrap"><canvas id="game" width="1024" height="576"></canvas></div>

<div id="summary" class="summary hidden" role="dialog" aria-modal="true">
  <div class="card">
    <h2>–ö–æ–Ω–µ—Ü —Ä–∞—É–Ω–¥–∞</h2>
    <p id="sumText"></p>
    <div style="text-align:center;margin-top:12px">
      <button id="restart" class="btn">üîÑ –ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>
    </div>
  </div>
</div>

<script>
(() => {
  const c = document.getElementById('game');
  const ctx = c.getContext('2d');
  const scoreEl = document.getElementById('score');
  const sumEl = document.getElementById('summary');
  const sumText = document.getElementById('sumText');
  const restartBtn = document.getElementById('restart');

  // ---------- –ú–ò–† ----------
  const WORLD_W = 3600, WORLD_H = c.height;
  const G = 0.7, AIR = 0.98, GROUND_FRIC = 0.84;
  const MAX_VX = 6.2, MAX_VY = 16;

  // –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º–∏ –≤–æ—Å—Å–æ–∑–¥–∞–¥–∏–º —Ç–≤–æ–∏ —ç—Å–∫–∏–∑—ã (–∫–∞–º–Ω–∏, –±–∞—à–Ω—è, –≤—ã—Å—Ç—É–ø—ã)
  const platforms = [
    {x:0, y:520, w:WORLD_W, h:200, color:'#c7baa1'},     // –∑–µ–º–ª—è
    // ¬´—Å–∫–∞–ª—ã¬ª –∏ –≤—ã—Å—Ç—É–ø—ã (–∫–∞—Ä—Ç–∏–Ω–∫–∞ 4)
    {x:280, y:430, w:120, h:18, color:'#b9ad90'},
    {x:430, y:380, w:120, h:18, color:'#b9ad90'},
    {x:600, y:330, w:110, h:18, color:'#b9ad90'},
    {x:860, y:470, w:180, h:18, color:'#b9ad90'},
    // –ø–ª–æ—Å–∫–∏–π –∫–∞–º–µ–Ω—å —É –∑–µ–º–ª–∏
    {x:980, y:500, w:140, h:20, color:'#b3a789'},
    // ¬´–±–∞—à–Ω—è¬ª –∏ –º–æ—Å—Ç–∏–∫ (–∫–∞—Ä—Ç–∏–Ω–∫–∞ 5)
    {x:1700, y:260, w:80, h:260, color:'#a8b8c6'},
    {x:1780, y:310, w:180, h:16, color:'#b9ad90'},
    {x:1980, y:360, w:140, h:16, color:'#b9ad90'},
    {x:2200, y:420, w:150, h:16, color:'#b9ad90'},
    // —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ –≤—ã—Å—Ç—É–ø—ã —Å–ø—Ä–∞–≤–∞
    {x:2600, y:450, w:160, h:18, color:'#b9ad90'},
    {x:2780, y:400, w:140, h:18, color:'#b9ad90'},
    {x:2980, y:350, w:140, h:18, color:'#b9ad90'},
  ];

  // ---------- –ò–ì–†–û–ö ----------
  const player = {
    x:60, y:420, w:40, h:56,
    vx:0, vy:0, dir:1,
    onGround:false,
    flying:false,
    doubleUsed:false,
    attackUntil:0
  };

  // ---------- –í–†–ê–ì–ò ----------
  const enemies = []; // {type, x,y,w,h, animT}
  const MAX_ENEMIES = 8;
  let score = 0;

  // ---------- –ß–ê–°–¢–ò–¶–´ (–±—Ä—ã–∑–≥–∏) ----------
  const parts = []; // {x,y,vx,vy,life}

  // ---------- –í–≤–æ–¥ ----------
  const keys = {left:false,right:false,up:false,down:false,attack:false};
  addEventListener('keydown', e=>{
    if(e.code==='KeyA'||e.code==='ArrowLeft') keys.left=true;
    if(e.code==='KeyD'||e.code==='ArrowRight') keys.right=true;
    if(e.code==='Space'){ if(!keys.up) jump(); keys.up=true; }
    if(e.code==='KeyS'||e.code==='ArrowDown') keys.down=true;
    if(e.code==='KeyX'){ attack(); }
    if(e.code==='KeyR'){ restart(); }
  });
  addEventListener('keyup', e=>{
    if(e.code==='KeyA'||e.code==='ArrowLeft') keys.left=false;
    if(e.code==='KeyD'||e.code==='ArrowRight') keys.right=false;
    if(e.code==='Space') keys.up=false;
    if(e.code==='KeyS'||e.code==='ArrowDown') keys.down=false;
  });

  // ---------- –§—É–Ω–∫—Ü–∏–∏ —Ñ–∏–∑–∏–∫–∏ ----------
  function clamp(v,a,b){ return Math.max(a,Math.min(b,v)); }
  function rects(a,b){ return !(a.x+a.w<b.x || a.x>b.x+b.w || a.y+a.h<b.y || a.y>b.y+b.h); }

  function moveAndCollide(e, dt){
    // –≤–µ—Ä—Ç–∏–∫–∞–ª—å
    const prevY = e.y, prevBottom = e.y + e.h, prevTop = e.y;
    e.vy += e.flying ? (keys.up? -0.2 : 0.25) : G;
    if(e.flying && keys.up) e.vy -= 0.45;            // –≤–∑–º–∞—Ö –∫—Ä—ã–ª—å—è–º–∏
    if(e.flying && keys.down) e.vy += 0.5;           // —Å–Ω–∏–∂–µ–Ω–∏–µ
    e.vy = clamp(e.vy, -MAX_VY, MAX_VY);
    e.onGround=false;
    e.y += e.vy;

    for(const p of platforms){
      if(!rects(e,p)) continue;
      // –ø—Ä–∏–∑–µ–º–ª–µ–Ω–∏–µ
      if(prevBottom <= p.y && e.y + e.h >= p.y){
        e.y = p.y - e.h; e.vy = 0; e.onGround=true; e.flying=false; e.doubleUsed=false;
      } else if(prevTop >= p.y + p.h && e.y <= p.y + p.h){
        // —É–¥–∞—Ä –≥–æ–ª–æ–≤–æ–π
        e.y = p.y + p.h; e.vy = 0.2;
      }
    }

    // –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å
    const accel = e.onGround ? 0.9 : 0.5;
    if(keys.left) { e.vx -= accel; e.dir=-1; }
    if(keys.right){ e.vx += accel; e.dir= 1; }
    e.vx *= (e.onGround? GROUND_FRIC : AIR);
    e.vx = clamp(e.vx, -MAX_VX, MAX_VX);

    const prevX = e.x;
    e.x += e.vx;
    for(const p of platforms){
      if(!rects(e,p)) continue;
      if(prevX + e.w <= p.x && e.x + e.w > p.x){ // —Å–ª–µ–≤–∞
        e.x = p.x - e.w; e.vx = 0;
      } else if(prevX >= p.x + p.w && e.x < p.x + p.w){ // —Å–ø—Ä–∞–≤–∞
        e.x = p.x + p.w; e.vx = 0;
      }
    }

    // –∫—Ä–∞—è –º–∏—Ä–∞
    e.x = clamp(e.x, 0, WORLD_W - e.w);
    if(e.y > WORLD_H-1){ e.y = WORLD_H-1; e.vy=0; e.onGround=true; e.flying=false; e.doubleUsed=false; }
  }

  function jump(){
    if(player.onGround){ player.vy = -13; player.onGround=false; return; }
    // –¥–≤–æ–π–Ω–æ–π –ø—Ä—ã–∂–æ–∫ => –≤–∫–ª—é—á–∞–µ–º –ø–æ–ª—ë—Ç
    if(!player.flying && !player.doubleUsed){
      player.doubleUsed = true;
      player.flying = true;
      // –Ω–µ–±–æ–ª—å—à–æ–π —Ç–æ–ª—á–æ–∫ –≤–≤–µ—Ä—Ö –ø—Ä–∏ –≤—Ö–æ–¥–µ –≤ –ø–æ–ª—ë—Ç
      player.vy = Math.min(player.vy, -6);
    }
  }

  function attack(){
    player.attackUntil = performance.now() + 180; // 0.18—Å
  }

  // ---------- –í—Ä–∞–≥–∏ ----------
  function spawnEnemy(){
    if(enemies.length >= MAX_ENEMIES) return;
    const type = Math.random()<0.55? 'kolobok' : 'chicken';
    let w,h;
    if(type==='kolobok'){ w=56; h=56; }
    else { w=70; h=54; }
    // —Å—Ç–∞–≤–∏–º –Ω–∞ –≤–µ—Ä—Ö–Ω—é—é –ø–ª–æ—â–∞–¥–∫—É, —á—Ç–æ –ø–æ–¥ –Ω–æ–≥–∞–º–∏ (–∏–ª–∏ –Ω–∞ –∑–µ–º–ª—é)
    const p = platforms[0]; // –∑–µ–º–ª—è
    const margin=140;
    let x = margin + Math.random()*(WORLD_W-2*margin);
    // –Ω–µ —Å–ø–∞–≤–Ω–∏—Ç—å –ø—Ä—è–º–æ –Ω–∞ –∏–≥—Ä–æ–∫–µ
    if(Math.abs(x - (player.x+player.w/2)) < 240) x += (x>player.x? 240:-240);
    const y = p.y - h;
    enemies.push({type,x,y,w,h,animT:Math.random()*1000,dead:false});
  }

  setInterval(spawnEnemy, 1200); // ¬´—á–∞—Å—Ç–æ¬ª

  // ---------- –ß–∞—Å—Ç–∏—Ü—ã (–≤–∑—Ä—ã–≤ –±—Ä—ã–∑–≥) ----------
  function splat(x,y){
    for(let i=0;i<30;i++){
      const a = Math.random()*Math.PI*2;
      const s = 2 + Math.random()*4;
      parts.push({x,y, vx:Math.cos(a)*s, vy:Math.sin(a)*s-2, life:600+Math.random()*500});
    }
  }

  // ---------- –ö–∞–º–µ—Ä–∞ ----------
  let camX = 0;
  function updateCamera(){
    camX = clamp(player.x + player.w/2 - c.width/2, 0, WORLD_W - c.width);
  }

  // ---------- –ò–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª ----------
  let last = performance.now();
  let running = true;

  function update(dt, now){
    moveAndCollide(player, dt);

    // –∞—Ç–∞–∫–∞ ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ø–∞–¥–∞–Ω–∏–π
    if(player.attackUntil > now){
      const atk = {
        x: player.dir>0? player.x+player.w-2 : player.x-34,
        y: player.y+6, w:36, h:40
      };
      for(const e of enemies){
        if(e.dead) continue;
        if(rects(atk, e)){
          e.dead = true; score++; scoreEl.textContent=score;
          splat(e.x+e.w/2, e.y+e.h/2);
        }
      }
    }

    // —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ —Å –≤—Ä–∞–≥–∞–º–∏, –µ—Å–ª–∏ –Ω–µ –∞—Ç–∞–∫—É–µ–º ‚Äî –ª—ë–≥–∫–∏–π –æ—Ç—Å–∫–æ–∫
    for(const en of enemies){
      if(en.dead) continue;
      if(rects(player, en) && player.attackUntil <= now){
        const dir = (player.x+player.w/2 < en.x+en.w/2)? -1 : 1;
        player.vx = 6*dir; player.vy = -8; // –æ—Ç–±—Ä–æ—Å
      }
    }

    // –æ—á–∏—â–∞–µ–º –º—ë—Ä—Ç–≤—ã—Ö –∏ —á–∞—Å—Ç–∏—Ü—ã
    for(let i=enemies.length-1;i>=0;i--) if(enemies[i].dead) enemies.splice(i,1);

    for(let i=parts.length-1;i>=0;i--){
      const p=parts[i]; p.life -= dt; p.x += p.vx; p.y += p.vy; p.vy += 0.35;
      if(p.life<=0) parts.splice(i,1);
    }

    updateCamera();
  }

  function render(now){
    ctx.clearRect(0,0,c.width,c.height);

    // —Ñ–æ–Ω (–Ω–µ–±–æ + –¥–∞–ª—å–Ω–∏–µ –≥–æ—Ä—ã/–≤–µ—Ç–∫–∞)
    const sky = ctx.createLinearGradient(0,0,0,c.height);
    sky.addColorStop(0,'#eaf3ff'); sky.addColorStop(1,'#e0eef7');
    ctx.fillStyle=sky; ctx.fillRect(0,0,c.width,c.height);

    ctx.save();
    ctx.translate(-camX,0);

    // –¥–∞–ª—å–Ω–∏–µ ¬´–∫—Ä–æ–Ω—ã¬ª
    ctx.strokeStyle='#c5d7e6'; ctx.lineWidth=14; ctx.beginPath();
    ctx.moveTo(150,120); ctx.bezierCurveTo(340,40, 520,140, 720,70);
    ctx.moveTo(1420,120); ctx.bezierCurveTo(1600,60, 1860,140, 2100,90);
    ctx.stroke();

    // –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã/–∑–µ–º–ª—è
    for(const p of platforms){
      ctx.fillStyle = p.color||'#b9ad90';
      ctx.fillRect(p.x, p.y, p.w, p.h||18);
      if(p===platforms[0]){ // –≤–µ—Ä—Ö–Ω–∏–π –±–æ—Ä–¥—é—Ä –∑–µ–º–ª–∏
        ctx.fillStyle='#b9ad90'; ctx.fillRect(p.x, p.y, p.w, 6);
      }
    }

    // –≤—Ä–∞–≥–∏
    for(const e of enemies){
      if(e.dead) continue;
      e.animT += 16;
      if(e.type==='kolobok') drawKolobok(e);
      else drawChicken(e);
    }

    // –∏–≥—Ä–æ–∫
    drawRaymon(player, now);

    // —á–∞—Å—Ç–∏—Ü—ã ¬´—á—ë—Ä–Ω—ã–µ –±—Ä—ã–∑–≥–∏¬ª
    for(const p of parts){
      const a = Math.max(0, Math.min(1, p.life/900));
      ctx.globalAlpha = a;
      ctx.fillStyle = '#222';
      ctx.beginPath(); ctx.arc(p.x, p.y, 3+Math.random()*2, 0, Math.PI*2); ctx.fill();
      ctx.globalAlpha = 1;
    }

    ctx.restore();
  }

  // ---------- –†–∏—Å–æ–≤–∞—à–∫–∏ ----------
  function drawRaymon(p, now){
    const flapping = (!p.onGround) ? (Math.sin(now/120)*8) : 0;

    // —Ç–µ–Ω—å
    ctx.fillStyle='rgba(0,0,0,.2)';
    ctx.beginPath(); ctx.ellipse(p.x+p.w/2, platforms[0].y+6, 22, 8, 0, 0, Math.PI*2); ctx.fill();

    // –∫—Ä—ã–ª—å—è
    ctx.fillStyle='#7aa0ff';
    const wingY = p.y + 10;
    const wingX = p.x + (p.dir>0? -18 : p.w+18);
    ctx.save();
    ctx.translate(wingX, wingY);
    ctx.rotate((p.dir>0? -1:1)*(Math.PI/8) + flapping*0.01);
    ctx.beginPath();
    ctx.moveTo(0,0); ctx.lineTo(-34, -18); ctx.lineTo(-64, -6); ctx.lineTo(-36, 10); ctx.closePath();
    ctx.fill();
    ctx.restore();

    // —Ç–µ–ª–æ (–ø–æ–ª–æ—Å–∫–∏ –∫–∞–∫ –Ω–∞ —Ä–∏—Å—É–Ω–∫–µ)
    ctx.fillStyle='#6fd4c7'; ctx.fillRect(p.x, p.y, p.w, p.h);              // –±–∞–∑–æ–≤—ã–π –æ–≤–∞–ª-¬´–±—Ä–æ–Ω—è¬ª
    ctx.strokeStyle='#185'; ctx.lineWidth=3;
    ctx.beginPath(); ctx.moveTo(p.x+6,p.y+8); ctx.lineTo(p.x+p.w-6,p.y+p.h-12); ctx.stroke();
    ctx.beginPath(); ctx.moveTo(p.x+6,p.y+p.h-10); ctx.lineTo(p.x+p.w-6,p.y+10); ctx.stroke();
    ctx.strokeStyle='#8241ff'; ctx.beginPath(); ctx.moveTo(p.x+6,p.y+p.h*0.55); ctx.lineTo(p.x+p.w-6,p.y+p.h*0.55); ctx.stroke();

    // –≥–æ–ª–æ–≤–∞ + –ø–∞—Å—Ç—å
    const hx = p.x + (p.dir>0? p.w : -22), hy = p.y-10;
    ctx.fillStyle='#4a3aa2'; ctx.fillRect(hx, hy, 22, 18);
    ctx.fillStyle='#1b2a2a'; ctx.fillRect(hx, hy+14, 22, 6);
    ctx.fillStyle='#0f7b5b'; ctx.fillRect(hx+14*(p.dir>0?0:1), hy+4, 4, 4); // –≥–ª–∞–∑

    // –º–µ—á (–∫–æ–≥–¥–∞ –∞—Ç–∞–∫–∞ ‚Äî –≤—ã–Ω–æ—Å–∏—Ç—Å—è –≤–ø–µ—Ä—ë–¥)
    const attacking = player.attackUntil > performance.now();
    const swLen = 30, swOff = attacking? 20: 8;
    const sx = p.dir>0? p.x+p.w-4 : p.x-4-swLen;
    const sy = p.y + 30 + (attacking? -6:0);
    ctx.fillStyle='#cfd2d8'; ctx.fillRect(sx + (p.dir>0? swOff: -swOff), sy, swLen, 6);
    ctx.fillStyle='#3b3b3b'; ctx.fillRect(sx-4 + (p.dir>0? swOff: -swOff), sy+2, 8, 10);

    // ¬´–æ–≥–æ–Ω—ë–∫¬ª –ø—Ä–∏ –ø–æ–ª—ë—Ç–µ
    if(p.flying && Math.floor(performance.now()/80)%2===0){
      ctx.fillStyle='rgba(255,120,40,.6)';
      ctx.beginPath(); ctx.ellipse(hx + (p.dir>0? 24:-8), hy+10, 12, 6, 0, 0, Math.PI*2); ctx.fill();
    }
  }

  function drawKolobok(e){
    // —Ç–µ–ª–æ
    ctx.fillStyle='#f7d37a';
    ctx.beginPath(); ctx.ellipse(e.x+e.w/2, e.y+e.h/2, e.w/2, e.h/2, 0, 0, Math.PI*2); ctx.fill();
    // —Ä–µ–º–Ω–∏-–∫—Ä–µ—Å—Ç—ã
    ctx.strokeStyle='#3d3d3d'; ctx.lineWidth=3;
    ctx.beginPath(); ctx.moveTo(e.x+10, e.y+10); ctx.lineTo(e.x+e.w-10, e.y+e.h-10); ctx.stroke();
    ctx.beginPath(); ctx.moveTo(e.x+e.w-10, e.y+10); ctx.lineTo(e.x+10, e.y+e.h-10); ctx.stroke();
    // –≥–ª–∞–∑–∞
    ctx.fillStyle='#333'; ctx.fillRect(e.x+18,e.y+18,6,6); ctx.fillRect(e.x+e.w-24,e.y+18,6,6);
    // ¬´–Ω–æ–∂–∏¬ª ‚Äî –º–∞—à–µ—Ç
    const a = Math.sin(e.animT/180)*10;
    ctx.fillStyle='#2a2a2a';
    ctx.fillRect(e.x-18, e.y+26+a, 18, 4);
    ctx.fillRect(e.x+e.w, e.y+26-a, 18, 4);
  }

  function drawChicken(e){
    // —Ç—É–ª–æ–≤–∏—â–µ
    ctx.fillStyle='#f0f0f0';
    ctx.beginPath(); ctx.ellipse(e.x+36, e.y+30, 30, 22, 0, 0, Math.PI*2); ctx.fill();
    // –ª–∞–ø—ã
    ctx.strokeStyle='#333'; ctx.lineWidth=3;
    ctx.beginPath(); ctx.moveTo(e.x+20, e.y+52); ctx.lineTo(e.x+16, e.y+60); ctx.moveTo(e.x+52, e.y+52); ctx.lineTo(e.x+56, e.y+60); ctx.stroke();
    // –¥–≤–µ —à–µ–∏ –∏ –≥–æ–ª–æ–≤—ã, ¬´–∫–ª—é—é—Ç¬ª
    const k = Math.sin(e.animT/140)*6;
    drawHead(e.x+8, e.y+10+k, -1);
    drawHead(e.x+48, e.y+12-k, 1);
    function drawHead(hx, hy, dir){
      ctx.strokeStyle='#333'; ctx.lineWidth=4;
      ctx.beginPath(); ctx.moveTo(hx,hy); ctx.lineTo(hx+dir*16, hy-10); ctx.stroke();
      ctx.fillStyle='#fff'; ctx.beginPath(); ctx.arc(hx+dir*18, hy-12, 7, 0, Math.PI*2); ctx.fill();
      ctx.fillStyle='#000'; ctx.beginPath(); ctx.arc(hx+dir*20, hy-14, 2, 0, Math.PI*2); ctx.fill();
      ctx.fillStyle='#ffa200'; ctx.beginPath(); ctx.moveTo(hx+dir*24, hy-12); ctx.lineTo(hx+dir*34, hy-8); ctx.lineTo(hx+dir*24, hy-4); ctx.closePath(); ctx.fill();
    }
  }

  // ---------- –†–µ–Ω–¥–µ—Ä/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ ----------
  function loop(t){
    const dt = Math.min(33, t-last); last=t;
    if(running){
      update(dt, t);
      render(t);
      requestAnimationFrame(loop);
    }
  }

  // ---------- –ö–æ–Ω–µ—Ü / –†–µ—Å—Ç–∞—Ä—Ç ----------
  function end(){
    running=false;
    sumText.innerHTML = `–ü–æ–±–µ–∂–¥–µ–Ω–æ –≤—Ä–∞–≥–æ–≤: <b>${score}</b>`;
    sumEl.classList.remove('hidden');
  }
  function restart(){
    score=0; scoreEl.textContent=0;
    player.x=60; player.y=420; player.vx=0; player.vy=0;
    player.flying=false; player.doubleUsed=false; player.onGround=false;
    enemies.length=0; parts.length=0; camX=0; sumEl.classList.add('hidden');
    running=true; last=performance.now(); requestAnimationFrame(loop);
  }
  restartBtn.addEventListener('click', restart);

  // –∑–∞–≤–µ—Ä—à–∏–º —Ä–∞—É–Ω–¥ —á–µ—Ä–µ–∑ 90 —Å–µ–∫—É–Ω–¥ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞
  setTimeout(()=>{ if(running) end(); }, 90000);

  // —Å—Ç–∞—Ä—Ç
  requestAnimationFrame(loop);
})();
</script>
</body>
</html>
      